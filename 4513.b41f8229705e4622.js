"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4513],{4513:(M,_,r)=>{r.r(_),r.d(_,{CadastrarOngPageModule:()=>J});var p=r(6814),c=r(95),s=r(3582),v=r(5233),h=r(3044),d=r(5861),e=r(6689),u=r(4414),g=r(6975),f=r(9393),T=r(768),P=r(7696),Z=r(83),S=r(6080),y=r(2321);function A(l,C){if(1&l&&(e.TgZ(0,"ion-select-option",26),e._uU(1),e.qZA()),2&l){const o=C.$implicit;e.s9C("value",o.sigla),e.xp6(1),e.Oqu(o.nome)}}function E(l,C){if(1&l&&(e.TgZ(0,"ion-select-option",26),e._uU(1),e.qZA()),2&l){const o=C.$implicit;e.s9C("value",o.id),e.xp6(1),e.Oqu(o.nome)}}const b=[{path:"",component:(()=>{class l{constructor(o,a,n,i,t,N,F,U,z,D){this.route=o,this.toastController=a,this.ongService=n,this.estadoService=i,this.colaboradorService=t,this.router=N,this.usuarioService=F,this.cidadeService=U,this.utilsService=z,this.geolocalizacaoService=D,this.usuario={},this.novaOng={nome_fantasia:"",cnpj:"",email:"",telefone:"",logradouro:"",numero:"",bairro:"",cep:"",cidade_id:0,descricao:"",situacao:"",logo_path:"",usuario_id:0},this.estados=[],this.cidades=[],this.estadoSelecionado="",this.cidadeSelecionada="",this.cidadeSelecionada_id="",this.selectDisabled=!0,this.telMask={mask:["(",/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/]},this.cepMask={mask:[/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/]},this.cnpjMask={mask:[/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/]},this.maskPredicate=function(){var m=(0,d.Z)(function*(O){return O.getInputElement()});return function(O){return m.apply(this,arguments)}}(),this.estadoService.getAll().then(m=>{this.estados=m}).catch(m=>{console.log(m)})}verificaEstados(){var o=this;return(0,d.Z)(function*(){o.estadoService.getAll().then(function(){var a=(0,d.Z)(function*(n){0==n.length&&(o.utilsService.presentToast("Importando estados e cidades, isso pode demorar um pouco..."),yield o.estadoService.importEstados(),yield o.cidadeService.importCidades())});return function(n){return a.apply(this,arguments)}}()).catch(a=>{console.log(a)})})()}onEstadoChange(o){this.cidadeService.getCidadeByEstado(o.detail.value).then(n=>{this.cidades=n||{},this.cidadeSelecionada="",this.selectDisabled=!1}).catch(n=>{console.log(n)})}onCidadeChange(o){this.cidadeService.getCidadeById(o.detail.value).then(n=>{this.cidadeSelecionada=n.nome,console.log(this.cidadeSelecionada)}).catch(n=>{this.utilsService.presentToastError(n.error.error)})}buscarEndereco(){var o=this;return(0,d.Z)(function*(){if(""==o.novaOng.cep)o.utilsService.presentToastWarning("Preencha o CEP");else{let a=parseInt(o.novaOng.cep.replace(/\D/g,""));yield o.geolocalizacaoService.getAddresByCEP(a).then(function(){var n=(0,d.Z)(function*(i){o.novaOng.logradouro=i.logradouro,o.novaOng.bairro=i.bairro,yield o.cidadeService.getCidadeByNome(i.uf,i.localidade).then(t=>{o.cidadeSelecionada=t.nome,o.cidadeSelecionada_id=t.id,o.estadoSelecionado=t.estado_sigla,o.selectDisabled=!1})});return function(i){return n.apply(this,arguments)}}())}})()}ngOnInit(){}presentToast(o){var a=this;return(0,d.Z)(function*(){(yield a.toastController.create({message:o,duration:4e3,position:"top"})).present()})()}adicionar(o){var a=this;return(0,d.Z)(function*(){console.log(a.novaOng),null!=a.arquivo&&(yield a.uploadFilesToServer()),a.usuario=yield a.usuarioService.getUsuarioLogado(),a.novaOng.usuario_id=a.usuario.id,a.novaOng.cidade_id=parseInt(a.cidadeSelecionada_id),console.log(a.novaOng),a.novaOng.situacao="A"==a.usuario.nivel?"Aprovada":"Pendente",a.camposValidos(o)&&a.ongService.create(a.novaOng).then(n=>{a.retorno=n,a.colaboradorService.create({usuario_id:a.usuario.id,ong_id:a.retorno.id,situacao:"Ativado",responsavel:"S"}).then(t=>{a.retorno=t}).catch(t=>{console.log(t)}),a.presentToast("Ong adicionada com sucesso!")}).catch(n=>{console.log(n)})})()}enviaOng(){this.adicionar(this.novaOng),setTimeout(()=>{this.voltaPagina()},1e3)}voltaPagina(){this.router.navigate(["listar-ong"])}camposValidos(o){for(const a in o)if(!o[a])return"string"==typeof o[a]&&o[a].trim(),!1;return!0}onUpload(o){this.arquivo=o.target.files}uploadFilesToServer(){var o=this;return(0,d.Z)(function*(){const a=new FormData;a.append("arquivo",o.arquivo[0]);try{let n=yield o.ongService.uploadArquivo(a);return null!=n&&(o.novaOng.logo_path=n.filename),n}catch(n){console.log(n),o.presentToast("N\xe3o foi possivel fazer o upload do arquivo!")}})()}static#e=this.\u0275fac=function(a){return new(a||l)(e.Y36(h.gz),e.Y36(u.yF),e.Y36(g.r),e.Y36(f.s),e.Y36(T.v),e.Y36(h.F0),e.Y36(P.i),e.Y36(Z.F),e.Y36(S.FW),e.Y36(y.z))};static#n=this.\u0275cmp=e.Xpm({type:l,selectors:[["app-cadastrar-ong"]],decls:59,vars:31,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],["size-lg","4","offset-lg","4","size-xs","12","offset-xs","0"],[2,"padding","15px"],["label","Nome Fantasia","labelPlacement","stacked","type","text","maxlength","50",3,"counter","ngModel","ngModelChange"],["label","CNPJ","labelPlacement","stacked","type","text",3,"maskito","maskitoElement","ngModel","ngModelChange"],["label","Email","labelPlacement","stacked","type","text","maxlength","45",3,"counter","ngModel","ngModelChange"],["label","Telefone","labelPlacement","stacked","type","text",3,"maskito","maskitoElement","ngModel","ngModelChange"],["label","Logradouro","labelPlacement","stacked","type","text","maxlength","45",3,"counter","ngModel","ngModelChange"],["label","N\xfamero","labelPlacement","stacked","type","text","maxlength","10",3,"counter","ngModel","ngModelChange"],["label","Bairro","labelPlacement","stacked","type","text","maxlength","45",3,"counter","ngModel","ngModelChange"],["label","CEP","labelPlacement","stacked","type","text","maxlength","9",3,"counter","maskito","maskitoElement","ngModel","ngModelChange"],["label-placement","floating",3,"ngModel","placeholder","ngModelChange","ionChange","click"],["slot","label"],["color","danger"],[3,"value",4,"ngFor","ngForOf"],["label-placement","floating",3,"disabled","ngModel","placeholder","ngModelChange","click","ionChange"],["label","Descri\xe7\xe3o","labelPlacement","stacked","type","text","maxlength","200",3,"counter","ngModel","ngModelChange"],["position","stacked"],["type","file","name","logo_path",3,"change"],["size-lg","6","offset-lg","3","size-xs","12","offset-xs","0"],["size","default","expand","block",3,"click"],["size","default","expand","block","fill","outline","routerLink","/listar-ong"],[3,"value"]],template:function(a,n){1&a&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Cadastro de Ong"),e.qZA()()(),e.TgZ(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),e._uU(10,"Adicionando ONG"),e.qZA()()(),e.TgZ(11,"ion-grid")(12,"ion-row")(13,"ion-col",5)(14,"ion-list",6)(15,"ion-item")(16,"ion-input",7),e.NdJ("ngModelChange",function(t){return n.novaOng.nome_fantasia=t}),e.qZA()(),e.TgZ(17,"ion-item")(18,"ion-input",8),e.NdJ("ngModelChange",function(t){return n.novaOng.cnpj=t}),e.qZA()(),e.TgZ(19,"ion-item")(20,"ion-input",9),e.NdJ("ngModelChange",function(t){return n.novaOng.email=t}),e.qZA()(),e.TgZ(21,"ion-item")(22,"ion-input",10),e.NdJ("ngModelChange",function(t){return n.novaOng.telefone=t}),e.qZA()(),e.TgZ(23,"ion-item")(24,"ion-input",11),e.NdJ("ngModelChange",function(t){return n.novaOng.logradouro=t}),e.qZA()(),e.TgZ(25,"ion-item")(26,"ion-input",12),e.NdJ("ngModelChange",function(t){return n.novaOng.numero=t}),e.qZA()(),e.TgZ(27,"ion-item")(28,"ion-input",13),e.NdJ("ngModelChange",function(t){return n.novaOng.bairro=t}),e.qZA()(),e.TgZ(29,"ion-item")(30,"ion-input",14),e.NdJ("ngModelChange",function(t){return n.novaOng.cep=t}),e.qZA()(),e.TgZ(31,"ion-item")(32,"ion-select",15),e.NdJ("ngModelChange",function(t){return n.estadoSelecionado=t})("ionChange",function(t){return n.onEstadoChange(t)})("click",function(){return n.verificaEstados()}),e.TgZ(33,"div",16),e._uU(34,"Estado"),e.TgZ(35,"ion-text",17),e._uU(36,"*"),e.qZA()(),e.YNc(37,A,2,2,"ion-select-option",18),e.qZA()(),e.TgZ(38,"ion-item")(39,"ion-select",19),e.NdJ("ngModelChange",function(t){return n.cidadeSelecionada_id=t})("click",function(){return n.verificaEstados()})("ionChange",function(t){return n.onCidadeChange(t)}),e.TgZ(40,"div",16),e._uU(41,"Cidade"),e.TgZ(42,"ion-text",17),e._uU(43,"*"),e.qZA()(),e.YNc(44,E,2,2,"ion-select-option",18),e.qZA()(),e.TgZ(45,"ion-item")(46,"ion-input",20),e.NdJ("ngModelChange",function(t){return n.novaOng.descricao=t}),e.qZA()(),e.TgZ(47,"ion-item")(48,"ion-label",21),e._uU(49,"Logo"),e.qZA(),e.TgZ(50,"input",22),e.NdJ("change",function(t){return n.onUpload(t)}),e.qZA()()()()(),e.TgZ(51,"ion-row")(52,"ion-col",23)(53,"ion-button",24),e.NdJ("click",function(){return n.enviaOng()}),e._uU(54,"Cadastrar"),e.qZA()()(),e.TgZ(55,"ion-row")(56,"ion-col",23)(57,"ion-button",25),e._uU(58,"Voltar"),e.qZA()()()()()),2&a&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("counter",!0)("ngModel",n.novaOng.nome_fantasia),e.xp6(2),e.Q6J("maskito",n.cnpjMask)("maskitoElement",n.maskPredicate)("ngModel",n.novaOng.cnpj),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.email),e.xp6(2),e.Q6J("maskito",n.telMask)("maskitoElement",n.maskPredicate)("ngModel",n.novaOng.telefone),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.logradouro),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.numero),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.bairro),e.xp6(2),e.Q6J("counter",!0)("maskito",n.cepMask)("maskitoElement",n.maskPredicate)("ngModel",n.novaOng.cep),e.xp6(2),e.Q6J("ngModel",n.estadoSelecionado)("placeholder",n.estadoSelecionado),e.xp6(5),e.Q6J("ngForOf",n.estados),e.xp6(2),e.Q6J("disabled",n.selectDisabled)("ngModel",n.cidadeSelecionada_id)("placeholder",n.cidadeSelecionada),e.xp6(5),e.Q6J("ngForOf",n.cidades),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.descricao))},dependencies:[p.sg,c.JJ,c.nD,c.On,s.YG,s.Sm,s.wI,s.W2,s.jY,s.Gu,s.pK,s.Ie,s.Q$,s.q_,s.fG,s.Nd,s.t9,s.n0,s.yW,s.wd,s.sr,s.QI,s.j9,s.YI,v.ro,h.rH]})}return l})()}];let k=(()=>{class l{static#e=this.\u0275fac=function(a){return new(a||l)};static#n=this.\u0275mod=e.oAB({type:l});static#a=this.\u0275inj=e.cJS({imports:[h.Bz.forChild(b),h.Bz]})}return l})(),J=(()=>{class l{static#e=this.\u0275fac=function(a){return new(a||l)};static#n=this.\u0275mod=e.oAB({type:l});static#a=this.\u0275inj=e.cJS({imports:[p.ez,c.u5,s.Pc,v.U5,k]})}return l})()},2321:(M,_,r)=>{r.d(_,{z:()=>h});var p=r(5861),c=r(6689),s=r(9862),v=r(6080);let h=(()=>{class d{constructor(u,g){this.http=u,this.utilsService=g,this.retorno={}}getAddres(u,g){var f=this;return(0,p.Z)(function*(){return f.http.get(`https://api.geoapify.com/v1/geocode/reverse?lat=${u}&lon=${g}&apiKey=e1c1fc95d3934d288f9fbadedeed9d1b`).toPromise()})()}getAddresByCEP(u){var g=this;return(0,p.Z)(function*(){return g.http.get(`https://viacep.com.br/ws/${u}/json/ `).toPromise()})()}static#e=this.\u0275fac=function(g){return new(g||d)(c.LFG(s.eN),c.LFG(v.FW))};static#n=this.\u0275prov=c.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);