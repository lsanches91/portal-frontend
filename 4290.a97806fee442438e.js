"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4290],{4290:(N,g,c)=>{c.r(g),c.d(g,{CriaAnimalPageModule:()=>J});var _=c(6814),d=c(95),s=c(3582),m=c(3044),r=c(5861),e=c(6689),h=c(4414),f=c(4781),v=c(8165),C=c(6448);function A(i,p){if(1&i&&(e.TgZ(0,"ion-select-option",24),e._uU(1),e.qZA()),2&i){const n=p.$implicit;e.s9C("value",n.id),e.xp6(1),e.Oqu(n.nome_comum)}}function Z(i,p){if(1&i&&(e.TgZ(0,"ion-select-option",24),e._uU(1),e.qZA()),2&i){const n=p.$implicit;e.s9C("value",n.id),e.xp6(1),e.Oqu(n.nome)}}function T(i,p){if(1&i){const n=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Cadastrar Esp\xe9cie"),e.qZA()()(),e.TgZ(4,"ion-content",25)(5,"ion-card",5)(6,"ion-item")(7,"ion-input",26),e.NdJ("ngModelChange",function(a){e.CHM(n);const t=e.oxw();return e.KtG(t.novaEspecie.nome_comum=a)}),e.qZA()(),e.TgZ(8,"ion-item")(9,"ion-input",27),e.NdJ("ngModelChange",function(a){e.CHM(n);const t=e.oxw();return e.KtG(t.novaEspecie.nome_cientifico=a)}),e.qZA()(),e.TgZ(10,"ion-button",21),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.enviaEspecie())}),e._uU(11," Enviar "),e.qZA(),e.TgZ(12,"ion-button",22),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.openCadastraEspecie(!1))}),e._uU(13," Voltar "),e.qZA()()()}if(2&i){const n=e.oxw();e.xp6(7),e.Q6J("counter",!0)("ngModel",n.novaEspecie.nome_comum),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaEspecie.nome_cientifico)}}function M(i,p){if(1&i&&(e.TgZ(0,"ion-select-option",24),e._uU(1),e.qZA()),2&i){const n=p.$implicit;e.s9C("value",n.id),e.xp6(1),e.Oqu(n.nome_comum)}}function P(i,p){if(1&i){const n=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3,"Cadastrar Ra\xe7a"),e.qZA()()(),e.TgZ(4,"ion-content",25)(5,"ion-card",5)(6,"ion-item")(7,"ion-input",6),e.NdJ("ngModelChange",function(a){e.CHM(n);const t=e.oxw();return e.KtG(t.novaRaca.nome=a)}),e.qZA()(),e.TgZ(8,"ion-select",28),e.NdJ("ngModelChange",function(a){e.CHM(n);const t=e.oxw();return e.KtG(t.novaRaca.especie_id=a)}),e.YNc(9,M,2,2,"ion-select-option",8),e.qZA(),e.TgZ(10,"ion-button",21),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.enviaRaca())}),e._uU(11," Enviar "),e.qZA(),e.TgZ(12,"ion-button",22),e.NdJ("click",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.openCadastraRaca(!1))}),e._uU(13," Voltar "),e.qZA()()()}if(2&i){const n=e.oxw();e.xp6(7),e.Q6J("counter",!0)("ngModel",n.novaRaca.nome),e.xp6(1),e.Q6J("ngModel",n.novaRaca.especie_id),e.xp6(1),e.Q6J("ngForOf",n.especies)}}const E=[{path:"",component:(()=>{class i{constructor(n,o,a,t,l,x,q){this.route=n,this.alertController=o,this.toastController=a,this.animalService=t,this.especieService=l,this.racaService=x,this.router=q,this.isModalEspecieOpen=!1,this.isModalRacaOpen=!1,this.novoAnimal={nome:"",idade:"",porte:"",descricao:"",situacao:"D",foto_path:"",ong_id:0,raca_id:"",raca_especie_id:""},this.novaEspecie={nome_comum:"",nome_cientifico:"",situacao:""},this.novaRaca={nome:"",especie_id:"",situacao:""},this.route.params.subscribe(u=>{u.id&&(this.ongSelecionadaID=+u.id)}),this.especieService.getEspecieBySituacao("Aprovado").then(u=>{this.especies=u}).catch(u=>{console.log(u)}),this.racaService.getRacaBySituacao("Aprovado").then(u=>{this.racas=u}).catch(u=>{console.log(u)})}postAnimal(n){var o=this;return(0,r.Z)(function*(){null!=o.arquivo&&(yield o.uploadFilesToServer()),o.animalService.create(n).then(a=>{o.retorno=a}).catch(a=>{console.log(a)})})()}enviaAnimal(){var n=this;return(0,r.Z)(function*(){n.novoAnimal.ong_id=n.ongSelecionadaID,n.camposValidos(n.novoAnimal)?yield n.animalService.getAnimalByNomeERaca(n.novoAnimal.nome,n.novoAnimal.raca_id).then(function(){var o=(0,r.Z)(function*(a){n.retorno=a,console.log(n.retorno),null!=n.retorno?n.confirmaCriacao(n.novoAnimal):(yield n.postAnimal(n.novoAnimal),n.presentToast("Animal cadastrado com sucesso!"),setTimeout(()=>{n.voltaPagina()},1e3))});return function(a){return o.apply(this,arguments)}}()).catch(o=>{console.log(o)}):n.presentToast("Preencha os campos obrigat\xf3rios.")})()}voltaPagina(){this.router.navigate([`ong-info/${this.ongSelecionadaID}`])}camposValidos(n){const o=["nome","idade","porte","raca_id","raca_especie_id"];for(const a of o)if(n.hasOwnProperty(a)&&(!n[a]||"string"==typeof n[a]&&""===n[a].trim()))return!1;return!0}onEspecieChange(n){"+ Cadastrar Esp\xe9cie"!=n.detail.value?this.racaService.getRacaByEspecieESituacao(n.detail.value,"Aprovado").then(a=>{this.racas=a||{}}).catch(a=>{console.log(a)}):this.openCadastraEspecie(!0)}onRacaChange(n){"+ Cadastrar Ra\xe7a"==n.detail.value&&this.openCadastraRaca(!0)}onUpload(n){this.arquivo=n.target.files}uploadFilesToServer(){var n=this;return(0,r.Z)(function*(){const o=new FormData;o.append("arquivo",n.arquivo[0]);try{let a=yield n.animalService.uploadArquivo(o);return null!=a&&(n.novoAnimal.foto_path=a.filename),a}catch(a){console.log(a),n.presentToast("N\xe3o foi possivel fazer o upload do arquivo!")}})()}openCadastraEspecie(n){var o=this;return(0,r.Z)(function*(){o.isModalEspecieOpen=n})()}postEspecie(n){var o=this;return(0,r.Z)(function*(){o.camposValidos(n)&&o.especieService.create(n).then(a=>{o.retorno=a}).catch(a=>{console.log(a)})})()}enviaEspecie(){this.novaEspecie.situacao="Pendente",this.postEspecie(this.novaEspecie),this.presentToast("Esp\xe9cie cadastrada com sucesso!"),setTimeout(()=>{this.openCadastraEspecie(!1),window.location.reload()},1e3)}openCadastraRaca(n){var o=this;return(0,r.Z)(function*(){o.isModalRacaOpen=n})()}postRaca(n){var o=this;return(0,r.Z)(function*(){o.camposValidos(n)&&o.racaService.create(n).then(a=>{o.retorno=a}).catch(a=>{console.log(a)})})()}enviaRaca(){this.novaRaca.situacao="Pendente",this.postRaca(this.novaRaca),this.presentToast("Ra\xe7a cadastrada com sucesso!"),setTimeout(()=>{this.openCadastraRaca(!1),window.location.reload()},1e3)}presentToast(n){var o=this;return(0,r.Z)(function*(){(yield o.toastController.create({message:n,duration:4e3,position:"top"})).present()})()}confirmaCriacao(n){var o=this;return(0,r.Z)(function*(){yield(yield o.alertController.create({header:"J\xe1 existe um animal com o mesmo Nome, Esp\xe9cie e Ra\xe7a. Deseja cadastrar mesmo assim?",buttons:[{text:"N\xe3o",handler:()=>{setTimeout(()=>{o.voltaPagina()},1e3)}},{text:"Sim",handler:()=>{o.postAnimal(n),o.presentToast("Animal cadastrado com sucesso!"),setTimeout(()=>{o.voltaPagina()},1e3)}}]})).present()})()}ngOnInit(){}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(m.gz),e.Y36(h.Br),e.Y36(h.yF),e.Y36(f.L),e.Y36(v.I),e.Y36(C.v),e.Y36(m.F0))};static#n=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-cria-animal"]],decls:54,vars:17,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],[2,"padding","15px"],["fill","solid","label","Nome","labelPlacement","stacked","type","text","maxlength","50",3,"counter","ngModel","ngModelChange"],["fill","solid","label","Esp\xe9cie","interface","popover","labelPlacement","stacked",3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["fill","solid","label","Ra\xe7a","interface","popover","labelPlacement","stacked",3,"ngModel","ngModelChange","ionChange"],["fill","solid","label","Idade","interface","popover","labelPlacement","stacked",3,"ngModel","ngModelChange"],["value","Filhote"],["value","Adulto"],["value","Idoso"],["fill","solid","label","Porte","interface","popover","labelPlacement","stacked",3,"ngModel","ngModelChange"],["value","Pequeno"],["value","M\xe9dio"],["value","Grande"],["position","stacked"],["type","file","name","foto_path",3,"change"],["fill","solid","label","Descri\xe7\xe3o","labelPlacement","stacked","type","text","maxlength","200",3,"counter","autoGrow","ngModel","ngModelChange"],["size","default","expand","block",3,"click"],["size","default","expand","block","fill","outline",3,"click"],[3,"isOpen","backdropDismiss"],[3,"value"],[1,"ion-padding"],["fill","solid","label","Nome Comum","labelPlacement","stacked","type","text","maxlength","50",3,"counter","ngModel","ngModelChange"],["fill","solid","label","Nome Cient\xedfico","labelPlacement","stacked","type","text","maxlength","50",3,"counter","ngModel","ngModelChange"],["fill","solid","label","Esp\xe9cie","interface","popover","labelPlacement","stacked",3,"ngModel","ngModelChange"]],template:function(o,a){1&o&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Adicionando Animal"),e.qZA()()(),e.TgZ(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),e._uU(10,"Adicionando Animal"),e.qZA()()(),e.TgZ(11,"ion-card",5)(12,"ion-item")(13,"ion-input",6),e.NdJ("ngModelChange",function(l){return a.novoAnimal.nome=l}),e.qZA()(),e.TgZ(14,"ion-item")(15,"ion-select",7),e.NdJ("ngModelChange",function(l){return a.novoAnimal.raca_especie_id=l})("ionChange",function(l){return a.onEspecieChange(l)}),e.YNc(16,A,2,2,"ion-select-option",8),e.TgZ(17,"ion-select-option"),e._uU(18,"+ Cadastrar Esp\xe9cie"),e.qZA()()(),e.TgZ(19,"ion-item")(20,"ion-select",9),e.NdJ("ngModelChange",function(l){return a.novoAnimal.raca_id=l})("ionChange",function(l){return a.onRacaChange(l)}),e.YNc(21,Z,2,2,"ion-select-option",8),e.TgZ(22,"ion-select-option"),e._uU(23,"+ Cadastrar Ra\xe7a"),e.qZA()()(),e.TgZ(24,"ion-item")(25,"ion-select",10),e.NdJ("ngModelChange",function(l){return a.novoAnimal.idade=l}),e.TgZ(26,"ion-select-option",11),e._uU(27,"Filhote"),e.qZA(),e.TgZ(28,"ion-select-option",12),e._uU(29,"Adulto"),e.qZA(),e.TgZ(30,"ion-select-option",13),e._uU(31,"Idoso"),e.qZA()()(),e.TgZ(32,"ion-item")(33,"ion-select",14),e.NdJ("ngModelChange",function(l){return a.novoAnimal.porte=l}),e.TgZ(34,"ion-select-option",15),e._uU(35,"Pequeno"),e.qZA(),e.TgZ(36,"ion-select-option",16),e._uU(37,"M\xe9dio"),e.qZA(),e.TgZ(38,"ion-select-option",17),e._uU(39,"Grande"),e.qZA()()(),e.TgZ(40,"ion-item")(41,"ion-label",18),e._uU(42,"Foto"),e.qZA(),e.TgZ(43,"input",19),e.NdJ("change",function(l){return a.onUpload(l)}),e.qZA()(),e.TgZ(44,"ion-item")(45,"ion-textarea",20),e.NdJ("ngModelChange",function(l){return a.novoAnimal.descricao=l}),e.qZA()(),e.TgZ(46,"ion-button",21),e.NdJ("click",function(){return a.enviaAnimal()}),e._uU(47," Enviar "),e.qZA(),e.TgZ(48,"ion-button",22),e.NdJ("click",function(){return a.voltaPagina()}),e._uU(49," Cancelar "),e.qZA()(),e.TgZ(50,"ion-modal",23),e.YNc(51,T,14,4,"ng-template"),e.qZA(),e.TgZ(52,"ion-modal",23),e.YNc(53,P,14,4,"ng-template"),e.qZA()()),2&o&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("fullscreen",!0),e.xp6(7),e.Q6J("counter",!0)("ngModel",a.novoAnimal.nome),e.xp6(2),e.Q6J("ngModel",a.novoAnimal.raca_especie_id),e.xp6(1),e.Q6J("ngForOf",a.especies),e.xp6(4),e.Q6J("ngModel",a.novoAnimal.raca_id),e.xp6(1),e.Q6J("ngForOf",a.racas),e.xp6(4),e.Q6J("ngModel",a.novoAnimal.idade),e.xp6(8),e.Q6J("ngModel",a.novoAnimal.porte),e.xp6(12),e.Q6J("counter",!0)("autoGrow",!0)("ngModel",a.novoAnimal.descricao),e.xp6(5),e.Q6J("isOpen",a.isModalEspecieOpen)("backdropDismiss",!1),e.xp6(2),e.Q6J("isOpen",a.isModalRacaOpen)("backdropDismiss",!1))},dependencies:[_.sg,d.JJ,d.nD,d.On,s.YG,s.Sm,s.PM,s.W2,s.Gu,s.pK,s.Ie,s.Q$,s.fG,s.t9,s.n0,s.g2,s.wd,s.sr,s.ki,s.QI,s.j9]})}return i})()}];let b=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#n=this.\u0275mod=e.oAB({type:i});static#a=this.\u0275inj=e.cJS({imports:[m.Bz.forChild(E),m.Bz]})}return i})(),J=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#n=this.\u0275mod=e.oAB({type:i});static#a=this.\u0275inj=e.cJS({imports:[_.ez,d.u5,s.Pc,b]})}return i})()}}]);