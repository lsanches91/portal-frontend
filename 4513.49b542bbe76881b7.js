"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4513],{4513:(M,_,s)=>{s.r(_),s.d(_,{CadastrarOngPageModule:()=>J});var p=s(6814),c=s(95),r=s(3582),v=s(5233),h=s(3044),d=s(5861),e=s(6689),u=s(4414),g=s(6975),f=s(9393),T=s(7696),P=s(83),Z=s(6080),y=s(2321);function S(l,C){if(1&l&&(e.TgZ(0,"ion-select-option",26),e._uU(1),e.qZA()),2&l){const a=C.$implicit;e.s9C("value",a.sigla),e.xp6(1),e.Oqu(a.nome)}}function A(l,C){if(1&l&&(e.TgZ(0,"ion-select-option",26),e._uU(1),e.qZA()),2&l){const a=C.$implicit;e.s9C("value",a.id),e.xp6(1),e.Oqu(a.nome)}}const E=[{path:"",component:(()=>{class l{constructor(a,t,n,i,o,b,N,F,U){this.route=a,this.toastController=t,this.ongService=n,this.estadoService=i,this.router=o,this.usuarioService=b,this.cidadeService=N,this.utilsService=F,this.geolocalizacaoService=U,this.usuario={},this.novaOng={nome_fantasia:"",cnpj:"",email:"",telefone:"",logradouro:"",numero:"",bairro:"",cep:"",cidade_id:0,descricao:"",situacao:"",logo_path:"",usuario_id:0},this.estados=[],this.cidades=[],this.estadoSelecionado="",this.cidadeSelecionada="",this.cidadeSelecionada_id="",this.selectDisabled=!0,this.telMask={mask:["(",/\d/,/\d/,")"," ",/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/,/\d/]},this.cepMask={mask:[/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/]},this.cnpjMask={mask:[/\d/,/\d/,".",/\d/,/\d/,/\d/,".",/\d/,/\d/,/\d/,"/",/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/]},this.maskPredicate=function(){var m=(0,d.Z)(function*(O){return O.getInputElement()});return function(O){return m.apply(this,arguments)}}(),this.estadoService.getAll().then(m=>{this.estados=m}).catch(m=>{console.log(m)})}verificaEstados(){var a=this;return(0,d.Z)(function*(){a.estadoService.getAll().then(function(){var t=(0,d.Z)(function*(n){0==n.length&&(a.utilsService.presentToast("Importando estados e cidades, isso pode demorar um pouco..."),yield a.estadoService.importEstados(),yield a.cidadeService.importCidades())});return function(n){return t.apply(this,arguments)}}()).catch(t=>{console.log(t)})})()}onEstadoChange(a){this.cidadeService.getCidadeByEstado(a.detail.value).then(n=>{this.cidades=n||{},this.cidadeSelecionada="",this.selectDisabled=!1}).catch(n=>{console.log(n)})}onCidadeChange(a){this.cidadeService.getCidadeById(a.detail.value).then(n=>{this.cidadeSelecionada=n.nome,console.log(this.cidadeSelecionada)}).catch(n=>{this.utilsService.presentToastError(n.error.error)})}buscarEndereco(){var a=this;return(0,d.Z)(function*(){if(""==a.novaOng.cep)a.utilsService.presentToastWarning("Preencha o CEP");else{let t=parseInt(a.novaOng.cep.replace(/\D/g,""));yield a.geolocalizacaoService.getAddresByCEP(t).then(function(){var n=(0,d.Z)(function*(i){a.novaOng.logradouro=i.logradouro,a.novaOng.bairro=i.bairro,yield a.cidadeService.getCidadeByNome(i.uf,i.localidade).then(o=>{a.cidadeSelecionada=o.nome,a.cidadeSelecionada_id=o.id,a.estadoSelecionado=o.estado_sigla,a.selectDisabled=!1})});return function(i){return n.apply(this,arguments)}}())}})()}ngOnInit(){}presentToast(a){var t=this;return(0,d.Z)(function*(){(yield t.toastController.create({message:a,duration:4e3,position:"top"})).present()})()}adicionar(a){var t=this;return(0,d.Z)(function*(){console.log(t.novaOng),null!=t.arquivo&&(yield t.uploadFilesToServer()),t.usuario=yield t.usuarioService.getUsuarioLogado(),t.novaOng.usuario_id=t.usuario.id,t.novaOng.cidade_id=parseInt(t.cidadeSelecionada_id),console.log(t.novaOng),t.novaOng.situacao="A"==t.usuario.nivel?"Aprovada":"Pendente",t.camposValidos(a)&&t.ongService.create(t.novaOng).then(n=>{t.retorno=n,t.presentToast("Ong adicionada com sucesso!")}).catch(n=>{console.log(n)})})()}enviaOng(){this.adicionar(this.novaOng),setTimeout(()=>{this.voltaPagina()},1e3)}voltaPagina(){this.router.navigate(["listar-ong"])}camposValidos(a){for(const t in a)if(!a[t])return"string"==typeof a[t]&&a[t].trim(),!1;return!0}onUpload(a){this.arquivo=a.target.files}uploadFilesToServer(){var a=this;return(0,d.Z)(function*(){const t=new FormData;t.append("arquivo",a.arquivo[0]);try{let n=yield a.ongService.uploadArquivo(t);return null!=n&&(a.novaOng.logo_path=n.filename),n}catch(n){console.log(n),a.presentToast("N\xe3o foi possivel fazer o upload do arquivo!")}})()}static#e=this.\u0275fac=function(t){return new(t||l)(e.Y36(h.gz),e.Y36(u.yF),e.Y36(g.r),e.Y36(f.s),e.Y36(h.F0),e.Y36(T.i),e.Y36(P.F),e.Y36(Z.FW),e.Y36(y.z))};static#n=this.\u0275cmp=e.Xpm({type:l,selectors:[["app-cadastrar-ong"]],decls:59,vars:31,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],["size-lg","4","offset-lg","4","size-xs","12","offset-xs","0"],[2,"padding","15px"],["label","Nome Fantasia","labelPlacement","stacked","type","text","maxlength","50",3,"counter","ngModel","ngModelChange"],["label","CNPJ","labelPlacement","stacked","type","text",3,"maskito","maskitoElement","ngModel","ngModelChange"],["label","Email","labelPlacement","stacked","type","text","maxlength","45",3,"counter","ngModel","ngModelChange"],["label","Telefone","labelPlacement","stacked","type","text",3,"maskito","maskitoElement","ngModel","ngModelChange"],["label","Logradouro","labelPlacement","stacked","type","text","maxlength","45",3,"counter","ngModel","ngModelChange"],["label","N\xfamero","labelPlacement","stacked","type","text","maxlength","10",3,"counter","ngModel","ngModelChange"],["label","Bairro","labelPlacement","stacked","type","text","maxlength","45",3,"counter","ngModel","ngModelChange"],["label","CEP","labelPlacement","stacked","type","text","maxlength","9",3,"counter","maskito","maskitoElement","ngModel","ngModelChange"],["label-placement","floating",3,"ngModel","placeholder","ngModelChange","ionChange","click"],["slot","label"],["color","danger"],[3,"value",4,"ngFor","ngForOf"],["label-placement","floating",3,"disabled","ngModel","placeholder","ngModelChange","click","ionChange"],["label","Descri\xe7\xe3o","labelPlacement","stacked","type","text","maxlength","200",3,"counter","ngModel","ngModelChange"],["position","stacked"],["type","file","name","logo_path",3,"change"],["size-lg","6","offset-lg","3","size-xs","12","offset-xs","0"],["size","default","expand","block",3,"click"],["size","default","expand","block","fill","outline","routerLink","/listar-ong"],[3,"value"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Cadastro de Ong"),e.qZA()()(),e.TgZ(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),e._uU(10,"Adicionando ONG"),e.qZA()()(),e.TgZ(11,"ion-grid")(12,"ion-row")(13,"ion-col",5)(14,"ion-list",6)(15,"ion-item")(16,"ion-input",7),e.NdJ("ngModelChange",function(o){return n.novaOng.nome_fantasia=o}),e.qZA()(),e.TgZ(17,"ion-item")(18,"ion-input",8),e.NdJ("ngModelChange",function(o){return n.novaOng.cnpj=o}),e.qZA()(),e.TgZ(19,"ion-item")(20,"ion-input",9),e.NdJ("ngModelChange",function(o){return n.novaOng.email=o}),e.qZA()(),e.TgZ(21,"ion-item")(22,"ion-input",10),e.NdJ("ngModelChange",function(o){return n.novaOng.telefone=o}),e.qZA()(),e.TgZ(23,"ion-item")(24,"ion-input",11),e.NdJ("ngModelChange",function(o){return n.novaOng.logradouro=o}),e.qZA()(),e.TgZ(25,"ion-item")(26,"ion-input",12),e.NdJ("ngModelChange",function(o){return n.novaOng.numero=o}),e.qZA()(),e.TgZ(27,"ion-item")(28,"ion-input",13),e.NdJ("ngModelChange",function(o){return n.novaOng.bairro=o}),e.qZA()(),e.TgZ(29,"ion-item")(30,"ion-input",14),e.NdJ("ngModelChange",function(o){return n.novaOng.cep=o}),e.qZA()(),e.TgZ(31,"ion-item")(32,"ion-select",15),e.NdJ("ngModelChange",function(o){return n.estadoSelecionado=o})("ionChange",function(o){return n.onEstadoChange(o)})("click",function(){return n.verificaEstados()}),e.TgZ(33,"div",16),e._uU(34,"Estado"),e.TgZ(35,"ion-text",17),e._uU(36,"*"),e.qZA()(),e.YNc(37,S,2,2,"ion-select-option",18),e.qZA()(),e.TgZ(38,"ion-item")(39,"ion-select",19),e.NdJ("ngModelChange",function(o){return n.cidadeSelecionada_id=o})("click",function(){return n.verificaEstados()})("ionChange",function(o){return n.onCidadeChange(o)}),e.TgZ(40,"div",16),e._uU(41,"Cidade"),e.TgZ(42,"ion-text",17),e._uU(43,"*"),e.qZA()(),e.YNc(44,A,2,2,"ion-select-option",18),e.qZA()(),e.TgZ(45,"ion-item")(46,"ion-input",20),e.NdJ("ngModelChange",function(o){return n.novaOng.descricao=o}),e.qZA()(),e.TgZ(47,"ion-item")(48,"ion-label",21),e._uU(49,"Logo"),e.qZA(),e.TgZ(50,"input",22),e.NdJ("change",function(o){return n.onUpload(o)}),e.qZA()()()()(),e.TgZ(51,"ion-row")(52,"ion-col",23)(53,"ion-button",24),e.NdJ("click",function(){return n.enviaOng()}),e._uU(54,"Cadastrar"),e.qZA()()(),e.TgZ(55,"ion-row")(56,"ion-col",23)(57,"ion-button",25),e._uU(58,"Voltar"),e.qZA()()()()()),2&t&&(e.Q6J("translucent",!0),e.xp6(6),e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("counter",!0)("ngModel",n.novaOng.nome_fantasia),e.xp6(2),e.Q6J("maskito",n.cnpjMask)("maskitoElement",n.maskPredicate)("ngModel",n.novaOng.cnpj),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.email),e.xp6(2),e.Q6J("maskito",n.telMask)("maskitoElement",n.maskPredicate)("ngModel",n.novaOng.telefone),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.logradouro),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.numero),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.bairro),e.xp6(2),e.Q6J("counter",!0)("maskito",n.cepMask)("maskitoElement",n.maskPredicate)("ngModel",n.novaOng.cep),e.xp6(2),e.Q6J("ngModel",n.estadoSelecionado)("placeholder",n.estadoSelecionado),e.xp6(5),e.Q6J("ngForOf",n.estados),e.xp6(2),e.Q6J("disabled",n.selectDisabled)("ngModel",n.cidadeSelecionada_id)("placeholder",n.cidadeSelecionada),e.xp6(5),e.Q6J("ngForOf",n.cidades),e.xp6(2),e.Q6J("counter",!0)("ngModel",n.novaOng.descricao))},dependencies:[p.sg,c.JJ,c.nD,c.On,r.YG,r.Sm,r.wI,r.W2,r.jY,r.Gu,r.pK,r.Ie,r.Q$,r.q_,r.fG,r.Nd,r.t9,r.n0,r.yW,r.wd,r.sr,r.QI,r.j9,r.YI,v.ro,h.rH]})}return l})()}];let k=(()=>{class l{static#e=this.\u0275fac=function(t){return new(t||l)};static#n=this.\u0275mod=e.oAB({type:l});static#a=this.\u0275inj=e.cJS({imports:[h.Bz.forChild(E),h.Bz]})}return l})(),J=(()=>{class l{static#e=this.\u0275fac=function(t){return new(t||l)};static#n=this.\u0275mod=e.oAB({type:l});static#a=this.\u0275inj=e.cJS({imports:[p.ez,c.u5,r.Pc,v.U5,k]})}return l})()},2321:(M,_,s)=>{s.d(_,{z:()=>h});var p=s(5861),c=s(6689),r=s(9862),v=s(6080);let h=(()=>{class d{constructor(u,g){this.http=u,this.utilsService=g,this.retorno={}}getAddres(u,g){var f=this;return(0,p.Z)(function*(){return f.http.get(`https://api.geoapify.com/v1/geocode/reverse?lat=${u}&lon=${g}&apiKey=e1c1fc95d3934d288f9fbadedeed9d1b`).toPromise()})()}getAddresByCEP(u){var g=this;return(0,p.Z)(function*(){return g.http.get(`https://viacep.com.br/ws/${u}/json/ `).toPromise()})()}static#e=this.\u0275fac=function(g){return new(g||d)(c.LFG(r.eN),c.LFG(v.FW))};static#n=this.\u0275prov=c.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);