"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6256],{6256:(k,f,r)=>{r.r(f),r.d(f,{ResgatePageModule:()=>U});var v=r(6814),p=r(95),l=r(3582),h=r(3044),c=r(5861),S=r(7838),e=r(6689),M=r(6080),Z=r(7696),T=r(9393),P=r(83),A=r(2321),E=r(7707),_=r(5233);function R(n,m){if(1&n&&(e.TgZ(0,"ion-select-option",18),e._uU(1),e.qZA()),2&n){const o=m.$implicit;e.s9C("value",o.sigla),e.xp6(1),e.Oqu(o.nome)}}function J(n,m){if(1&n&&(e.TgZ(0,"ion-select-option",18),e._uU(1),e.qZA()),2&n){const o=m.$implicit;e.s9C("value",o.id),e.xp6(1),e.Oqu(o.nome)}}const y=[{path:"",component:(()=>{class n{constructor(o,i,a,s,t,g,u){this.utilsService=o,this.usuarioService=i,this.estadoService=a,this.cidadeService=s,this.geolocalizacaoService=t,this.resgateService=g,this.router=u,this.descricao="",this.especie="",this.cep="",this.logradouroAproximado="",this.numeroAproximado="",this.pontoReferencia="",this.usuarioLogado={},this.estados=[],this.cidades=[],this.estadoSelecionado="",this.cidadeSelecionada="",this.cidadeSelecionada_id="",this.selectDisabled=!0,this.cepMask={mask:[/\d/,/\d/,/\d/,/\d/,/\d/,"-",/\d/,/\d/,/\d/]},this.maskPredicate=function(){var d=(0,c.Z)(function*(C){return C.getInputElement()});return function(C){return d.apply(this,arguments)}}(),this.getUsuarioLogado(),this.estadoService.getAll().then(d=>{this.estados=d}).catch(d=>{console.log(d)})}verificaEstados(){var o=this;return(0,c.Z)(function*(){o.estadoService.getAll().then(function(){var i=(0,c.Z)(function*(a){0==a.length&&(o.utilsService.presentToast("Importando estados e cidades, isso pode demorar um pouco..."),yield o.estadoService.importEstados(),yield o.cidadeService.importCidades(),o.estados=a)});return function(a){return i.apply(this,arguments)}}()).catch(i=>{console.log(i)})})()}ngOnInit(){}getLocalizacao(){var o=this;return(0,c.Z)(function*(){o.utilsService.presentToast("Buscando localiza\xe7\xe3o, isso pode demorar um pouco...");const i=yield S.b.getCurrentPosition(),a=yield o.geolocalizacaoService.getAddres(i.coords.latitude,i.coords.longitude);o.cep=a.features[0].properties.postcode,o.numeroAproximado=a.features[0].properties.housenumber,o.logradouroAproximado=a.features[0].properties.street;let s=parseInt(o.cep.replace(/\D/g,""));yield o.geolocalizacaoService.getAddresByCEP(s).then(function(){var t=(0,c.Z)(function*(g){yield o.cidadeService.getCidadeByNome(g.uf,g.localidade).then(u=>{o.estadoSelecionado=u.estado_sigla,o.cidadeService.getCidadeByEstado(o.estadoSelecionado).then(d=>{o.cidades=d||{},o.selectDisabled=!1}).catch(d=>{console.log(d)}),o.cidadeSelecionada=u.nome,o.cidadeSelecionada_id=u.id})});return function(g){return t.apply(this,arguments)}}())})()}getUsuarioLogado(){var o=this;return(0,c.Z)(function*(){o.usuarioLogado=yield o.usuarioService.getUsuarioLogado()})()}enviarSolicitacao(){var o=this;return(0,c.Z)(function*(){if(""==o.descricao||""==o.especie||""==o.cep||""==o.logradouroAproximado||""==o.numeroAproximado||""==o.cidadeSelecionada||""==o.estadoSelecionado||""==o.pontoReferencia)o.utilsService.presentToastWarning("Preencha todos os campos");else{const i={descricao:o.descricao,especie:o.especie,cep:o.cep,logradouro_aproximado:o.logradouroAproximado,numero_aproximado:o.numeroAproximado,cidade_id:parseInt(o.cidadeSelecionada_id),ponto_referencia:o.pontoReferencia,situacao:"P",usuario_id:o.usuarioLogado.id};yield o.resgateService.create(i).then(s=>{o.utilsService.presentToastSuccess("Solicita\xe7\xe3o de resgate enviada com sucesso"),o.router.navigate(["/home"])}).catch(s=>{o.utilsService.presentToastError(s.error.error)})}})()}onEstadoChange(o){this.cidadeService.getCidadeByEstado(o.detail.value).then(a=>{this.cidades=a||{},this.cidadeSelecionada="",this.selectDisabled=!1}).catch(a=>{console.log(a)})}onCidadeChange(o){this.cidadeService.getCidadeById(o.detail.value).then(a=>{this.cidadeSelecionada=a.nome,console.log(this.cidadeSelecionada)}).catch(a=>{this.utilsService.presentToastError(a.error.error)})}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(M.FW),e.Y36(Z.i),e.Y36(T.s),e.Y36(P.F),e.Y36(A.z),e.Y36(E.k),e.Y36(h.F0))};static#o=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-resgate"]],decls:37,vars:16,consts:[[3,"translucent"],["slot","start"],["default-href","#"],[1,"ion-text-center"],["label","Esp\xe9cie","labelPlacement","floating","placeholder","Insira a esp\xe9cie",3,"ngModel","ngModelChange"],["label","Descri\xe7\xe3o","labelPlacement","floating","rows","4","placeholder","Insira a descri\xe7\xe3o do animal",3,"ngModel","ngModelChange"],[2,"margin","10px",3,"click"],["name","map-outline"],["label","CEP","labelPlacement","floating","placeholder","Insira o CEP",3,"ngModel","maskito","maskitoElement","ngModelChange"],["label","Logradouro","labelPlacement","floating","placeholder","Insira a logradouro aproximado",2,"width","150%",3,"ngModel","ngModelChange"],["label","Numero","labelPlacement","floating","placeholder","Insira o numero aproximado",3,"ngModel","ngModelChange"],["label-placement","floating",3,"ngModel","placeholder","ngModelChange","ionChange","click"],["slot","label"],["color","danger"],[3,"value",4,"ngFor","ngForOf"],["label-placement","stacked",3,"disabled","ngModel","placeholder","ngModelChange","click","ionChange"],["label","Ponto de refer\xeancia","labelPlacement","floating","placeholder","Insira um ponto de refer\xeancia",3,"ngModel","ngModelChange"],["expand","block","color","success",2,"margin","10px",3,"click"],[3,"value"]],template:function(i,a){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title",3),e._uU(5,"Solicita\xe7\xe3o de Resgate"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-card")(8,"ion-item")(9,"ion-input",4),e.NdJ("ngModelChange",function(t){return a.especie=t}),e.qZA()(),e.TgZ(10,"ion-item")(11,"ion-textarea",5),e.NdJ("ngModelChange",function(t){return a.descricao=t}),e.qZA()(),e.TgZ(12,"ion-button",6),e.NdJ("click",function(){return a.getLocalizacao()}),e._UZ(13,"ion-icon",7),e._uU(14,"Utilizar Geolocaliza\xe7\xe3o"),e.qZA(),e.TgZ(15,"ion-item")(16,"ion-input",8),e.NdJ("ngModelChange",function(t){return a.cep=t}),e.qZA()(),e.TgZ(17,"ion-item")(18,"ion-input",9),e.NdJ("ngModelChange",function(t){return a.logradouroAproximado=t}),e.qZA(),e.TgZ(19,"ion-input",10),e.NdJ("ngModelChange",function(t){return a.numeroAproximado=t}),e.qZA()(),e.TgZ(20,"ion-item")(21,"ion-select",11),e.NdJ("ngModelChange",function(t){return a.estadoSelecionado=t})("ionChange",function(t){return a.onEstadoChange(t)})("click",function(){return a.verificaEstados()}),e.TgZ(22,"div",12),e._uU(23,"Estado"),e.TgZ(24,"ion-text",13),e._uU(25,"*"),e.qZA()(),e.YNc(26,R,2,2,"ion-select-option",14),e.qZA(),e.TgZ(27,"ion-select",15),e.NdJ("ngModelChange",function(t){return a.cidadeSelecionada_id=t})("click",function(){return a.verificaEstados()})("ionChange",function(t){return a.onCidadeChange(t)}),e.TgZ(28,"div",12),e._uU(29,"Cidade"),e.TgZ(30,"ion-text",13),e._uU(31,"*"),e.qZA()(),e.YNc(32,J,2,2,"ion-select-option",14),e.qZA()(),e.TgZ(33,"ion-item")(34,"ion-input",16),e.NdJ("ngModelChange",function(t){return a.pontoReferencia=t}),e.qZA()(),e.TgZ(35,"ion-button",17),e.NdJ("click",function(){return a.enviarSolicitacao()}),e._uU(36,"Enviar"),e.qZA()()()),2&i&&(e.Q6J("translucent",!0),e.xp6(9),e.Q6J("ngModel",a.especie),e.xp6(2),e.Q6J("ngModel",a.descricao),e.xp6(5),e.Q6J("ngModel",a.cep)("maskito",a.cepMask)("maskitoElement",a.maskPredicate),e.xp6(2),e.Q6J("ngModel",a.logradouroAproximado),e.xp6(1),e.Q6J("ngModel",a.numeroAproximado),e.xp6(2),e.Q6J("ngModel",a.estadoSelecionado)("placeholder",a.estadoSelecionado),e.xp6(5),e.Q6J("ngForOf",a.estados),e.xp6(1),e.Q6J("disabled",a.selectDisabled)("ngModel",a.cidadeSelecionada_id)("placeholder",a.cidadeSelecionada),e.xp6(5),e.Q6J("ngForOf",a.cidades),e.xp6(2),e.Q6J("ngModel",a.pontoReferencia))},dependencies:[v.sg,p.JJ,p.On,l.YG,l.Sm,l.PM,l.W2,l.Gu,l.gu,l.pK,l.Ie,l.t9,l.n0,l.yW,l.g2,l.wd,l.sr,l.QI,l.j9,l.oU,_.ro]})}return n})()}];let b=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#o=this.\u0275mod=e.oAB({type:n});static#a=this.\u0275inj=e.cJS({imports:[h.Bz.forChild(y),h.Bz]})}return n})(),U=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#o=this.\u0275mod=e.oAB({type:n});static#a=this.\u0275inj=e.cJS({imports:[v.ez,p.u5,l.Pc,_.U5,b]})}return n})()}}]);